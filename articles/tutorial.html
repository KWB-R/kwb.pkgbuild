<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create KWB-R Package from Scratch • kwb.pkgbuild</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Create KWB-R Package from Scratch">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kwb.pkgbuild</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/install.html">How to Install KWB-R Packages From GitHub</a>
    </li>
    <li>
      <a href="../articles/tutorial.html">Create KWB-R Package from Scratch</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/KWB-R/kwb.pkgbuild">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Create KWB-R Package from Scratch</h1>
                        <h4 class="author">Michael Rustler, Hauke Sonnenberg</h4>
            
            <h4 class="date">2019-09-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/KWB-R/kwb.pkgbuild/blob/master/vignettes/tutorial.Rmd"><code>vignettes/tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<p>This tutorial explains how to setup an R package so that it complies with a default style. We would like to apply this default style to all KWB-packages that are hosted on our GitHub account KWB-R. The aim is to present all packages in a common manner (consistent DESCRIPTION and documentation) and to use the same services (continuous integration, code coverage) for all our packages.</p>
<p>This package provides functions to:</p>
<ul>
<li>generate a <a href="http://r-pkgs.had.co.nz/description.html">DESCRIPTION</a> file in which fields are already set to “our” defaults. For example, the licence field will be set to the open source licence MIT. An additional LICENCE file will be added that informs about KWB being the copyright holder of the package.</li>
<li>generate files that control the automatic generation of documentation files.</li>
<li>generate files that control continuous integration, i.e. the automatic building and testing of the package.</li>
</ul>
<div id="install-required-r-packages" class="section level1">
<h1 class="hasAnchor">
<a href="#install-required-r-packages" class="anchor"></a>1 Install required R packages</h1>
<p>Before you can use the package kwb.pkgdown you need to</p>
<ul>
<li>install packages that kwb.pkgdown relies on from <a href="https://cloud.r-project.org">The Comprehensive R Archive Network (CRAN)</a>,</li>
<li>install kwb.pkddown from <a href="https://github.com/kwb-r/kwb.pkgdown">GitHub</a>.</li>
</ul>
<p>Install required packages that are not yet available in your local R user library from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Get the names of already installed packages</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">installed_packages &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(<span class="kw"><a href="https://rdrr.io/r/utils/installed.packages.html">installed.packages</a></span>())</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Define the names of required packages:</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># - remotes: functions to install R packages from Github</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co"># - pkgdown: functions to create a package website</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">required_packages &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"remotes"</span>, <span class="st">"pkgdown"</span>)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co"># Determine the packages that are not yet installed</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">packages_to_install &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sets.html">setdiff</a></span>(required_packages, installed_packages)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># Install the packages from CRAN</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="cf">for</span> (package <span class="cf">in</span> packages_to_install) {</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  </a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(package, <span class="dt">repos =</span> <span class="st">"https://cloud.r-project.org"</span>)</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">}</a></code></pre></div>
<p>The remotes package that should now be installed, allows to install packages directly from GitHub. Therefore, the functions from this package need to communicate with the GitHub server. As it is best for users to get explicitly authenticated by the GitHub server we will set a so called Private Access Token (PAT) in the following. This token will then automatically be used whenever the GitHub server is accessed. Please see the <a href="install.html">Installation vignette</a> first to learn how to get your personal GitHub PAT and use that token instead of <code>Put your Private Access Token here</code> in the following command:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span>(<span class="dt">GITHUB_PAT =</span> <span class="st">"Put your Private Access Token here"</span>)</a></code></pre></div>
<p>Now, that the access token is set, you can use <code>install_github()</code> from the remotes packages to install packages directly from GitHub. Let’s start by installing a fully working version of the remotes package itself (unfortunately, the current CRAN version as installed above contains a bug…):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"r-lib/remotes@18c7302637053faf21c5b025e1e9243962db1bdc"</span>)</a></code></pre></div>
<p>Finally we can install the latest version of this package from our GitHub account:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">remotes<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/remotes/man/install_github.html">install_github</a></span>(<span class="st">"KWB-R/kwb.pkgbuild"</span>)</a></code></pre></div>
</div>
<div id="configure-and-create-your-package" class="section level1">
<h1 class="hasAnchor">
<a href="#configure-and-create-your-package" class="anchor"></a>2 Configure and create your package</h1>
<p>Secondly you need to personalise your R package by adapting a default template that we provide for KWB packages. This template is contained in the R package <code>kwb.pkgbuild</code>.</p>
<div id="prepare-a-package-directory" class="section level2">
<h2 class="hasAnchor">
<a href="#prepare-a-package-directory" class="anchor"></a>2.1 Prepare a package directory</h2>
<p>In the best case, your package will be under version control. We encourage you to create a GitHub repository on our <a href="https://github.com/kwb-r">GitHub account</a> that represents the package. Having a package as a repository on GitHub has the advantage that it can be easily installed directly from there with no more than running <code><a href="https://rdrr.io/pkg/remotes/man/install_github.html">remotes::install_github("kwb-r/&lt;package_name&gt;")</a></code>. Once you have created the GitHub repository, <a href="https://help.github.com/articles/cloning-a-repository/">clone</a> it to a folder on your local machine.</p>
<p>You can let RStudio do the cloning for you. Therefore,</p>
<ul>
<li>select “File &gt; New Project…” from the main menu,</li>
<li>select “Version Control &gt; Git”,</li>
<li>set “Repository URL” to your new repository, such as <code>https://github.com/kwb-r/&lt;package_name&gt;</code>,</li>
<li>set “Project directory name” to your <code>&lt;package_name&gt;</code> (this should be the default),</li>
<li>set “Create project as subdirectory of” to the folder in which you want to store your local copies of your github repositories, e.g. to <code>~/github-repos</code>.</li>
<li>click on “Create Project” to let RStudio copy the package repository from GitHub onto your local machine.</li>
</ul>
<p>For the steps described in the following, you need to provide the name of the package in a variable <code>package</code> and the path to the local directory to which GitHub repositories are cloned in a variable <code>repo_dir</code>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Set the name of your (!) new package</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">package &lt;-<span class="st"> "kwb.newpackage"</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># Set the path to your (!) local folder to which GitHub repositories are cloned</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">repo_dir &lt;-<span class="st"> "~/github-repos"</span></a></code></pre></div>
</div>
<div id="create-empty-r-package" class="section level2">
<h2 class="hasAnchor">
<a href="#create-empty-r-package" class="anchor"></a>2.2 Create empty R package</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Set the path to the package directory</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">pkg_dir &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(repo_dir, package)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Create directory for R package</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">kwb.pkgbuild<span class="op">::</span><span class="kw">create_pkg_dir</span>(pkg_dir)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; /tmp/RtmpYcCwAv/kwb.newpackage is a valid 'root_dir' for pkg 'kwb.newpackage'</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; Warning: `recursive` is deprecated, please use `recurse` instead</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; [1] "/tmp/RtmpYcCwAv/kwb.newpackage"</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># Create a default package structure</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">withr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/withr/man/with_dir.html">with_dir</a></span>(pkg_dir, {kwb.pkgbuild<span class="op">::</span><span class="kw">use_pkg_skeleton</span>(package)})</a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; ✔ Setting active project to '/tmp/RtmpYcCwAv/kwb.newpackage'</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; ✔ Writing 'kwb.newpackage.Rproj'</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; ✔ Adding '.Rproj.user' to '.gitignore'</span></a></code></pre></div>
</div>
<div id="parameterise-your-r-package" class="section level2">
<h2 class="hasAnchor">
<a href="#parameterise-your-r-package" class="anchor"></a>2.3 Parameterise your R package</h2>
<p>In the following, we present the commands required to setup and create your new package. We suggest that you write the corresponding code into a <code>.R</code> script file (e.g. <code>setup_package.R</code>). Once the package is created, we suggest to put the script file into the <code>inst/extdata</code> folder of your package. This makes the creation of the package reproducible and can be used as a template for the creation of further packages.</p>
<div id="author" class="section level3">
<h3 class="hasAnchor">
<a href="#author" class="anchor"></a>Author</h3>
<p>Minimum requirement: the author needs at least to have a (full) name:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">author &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">name =</span> <span class="st">"Max Mustermann"</span>)</a></code></pre></div>
<p>You can add further information such as a personal website or the <a href="https://orcid.org/">ORCID</a> of the author:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">author &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="dt">name =</span> <span class="st">"Michael Rustler"</span>, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="dt">orcid =</span> <span class="st">"0000-0003-0647-7726"</span>,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  <span class="dt">url =</span> <span class="st">"http://mrustl.de"</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">)</a></code></pre></div>
<p>The ORCID uniquely identifies the author of a web ressource and thus allows to find different works of one and the same author on the web.</p>
<p>If you do not know your ORCID, have a look at our package <a href="https://github.com/kwb-r/kwb.orcid">kwb.orcid</a>. It allows to search ORCIDs by name, once you have created an account at <a href="https://orcid.org/">orcid.org</a>.</p>
<p>In addition, this package stores the ORCIDs of KWB researchers of whom we know their ORCID. Once you have kwb.orcid installed, you can access these ORCIDs with:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">kwb.orcid<span class="op">::</span><span class="kw">get_kwb_orcids</span>()</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; Registered S3 method overwritten by 'crul':</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;   method                 from</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;   as.character.form_file httr</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt;     Andreas Matzinger      Hauke Sonnenberg         Wolfgang Seis </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; "0000-0001-5483-4594" "0000-0001-9134-2871" "0000-0002-7436-8575" </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt;    Christoph Sprenger       Michael Rustler </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; "0000-0002-0178-6645" "0000-0003-0647-7726"</span></a></code></pre></div>
</div>
<div id="package-description" class="section level3">
<h3 class="hasAnchor">
<a href="#package-description" class="anchor"></a>Package description</h3>
<p>The package description needs three entries</p>
<ul>
<li><p><strong>name</strong>: name of the package</p></li>
<li><p><strong>title</strong>: title of your R package (which is automatically converted to title case with the function <code><a href="https://rdrr.io/r/tools/toTitleCase.html">tools::toTitleCase()</a></code>)</p></li>
<li><p><strong>desc:</strong> package description. Should be at least one sentence long and needs to end with a period!</p></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">description &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="dt">name =</span> package, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  <span class="dt">title =</span> <span class="st">"My new KWB R package"</span>, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">desc  =</span> <span class="st">"My super cool new R package in KWB default styling."</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">)</a></code></pre></div>
</div>
</div>
<div id="create-r-package-structure-in-kwb-r-style" class="section level2">
<h2 class="hasAnchor">
<a href="#create-r-package-structure-in-kwb-r-style" class="anchor"></a>2.4 Create R package structure in KWB-R style</h2>
<p>Running the following code not only creates an R package structure but also adds some KWB-R specfic styling, e.g.:</p>
<ul>
<li>
<p>Adding configution files for:</p>
<ul>
<li><p>Continous integration on windows (<a href="https://appveyor.com" class="uri">https://appveyor.com</a>) and linux (<a href="https://travis-ci.org/KWB-R" class="uri">https://travis-ci.org/KWB-R</a>)</p></li>
<li><p>Code coverage in R package using the servive <a href="codecov.io" class="uri">codecov.io</a></p></li>
<li><p>Backup of Github repositories on our mirrored KWB-R group on <a href="https://gitlab.com/KWB-R">Gitlab</a></p></li>
</ul>
</li>
<li><p>Indicates the current lifecycle of the R package according to <a href="https://www.tidyverse.org/lifecycle/" class="uri">https://www.tidyverse.org/lifecycle/</a></p></li>
<li><p>Uses by default the permissive <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="MIT"></a> for all public R packages currently hosted on Github (see: <a href="http://kwb-r.github.io/status/" class="uri">http://kwb-r.github.io/status/</a>) and lists KWB as copyright holder (see e.g. <a href="https://kwb-r.github.io/kwb.pkgbuild/authors.html">here</a>)</p></li>
<li><p>Creates <code>README</code> files (<code>README.Rmd</code> and <code>README.md</code>) for the above mentioned topics and</p></li>
<li><p>Prepares a KWB-R flavored documentation website template named <code>_packagedown.yml</code> needed by <a href="http://pkgdown.r-lib.org/" class="uri">http://pkgdown.r-lib.org/</a></p></li>
</ul>
<p>Running the following R function will create the R package with the <code>version</code> = <code>0.0.0.9000</code> and development stage <code>experimental</code> (defined <a href="https://www.tidyverse.org/lifecycle/#experimental">here</a>).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span>(pkg_dir)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">kwb.pkgbuild<span class="op">::</span><span class="kw">use_pkg</span>(</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  author, </a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  description, </a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">version =</span> <span class="st">"0.0.0.9000"</span>, </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="dt">stage =</span> <span class="st">"experimental"</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">)</a></code></pre></div>
</div>
<div id="add-your-r-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#add-your-r-functions" class="anchor"></a>2.5 Add your R functions</h2>
<p>Add your R functions in the folder <code>R</code>/. By using <code><a href="https://usethis.r-lib.org/reference/use_r.html">usethis::use_r</a></code> with the parameter <code>name</code> = <code>function</code> an empty R script is already stored in the right folder <code>R/</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">usethis<span class="op">::</span><span class="kw"><a href="https://usethis.r-lib.org/reference/use_r.html">use_r</a></span>(<span class="st">"function"</span>)</a></code></pre></div>
<p>For writing your R code/functions please follow the tidyverse coding style (<a href="https://style.tidyverse.org/" class="uri">https://style.tidyverse.org/</a>), which serves as our default KWB-R style.</p>
<p>Now you just need to fill it with content (i.e. your functions) and document it using <a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html">roxygen2</a>. If you have already defined a function you can add a <a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html">roxygen2</a> skeleton by using clicking on the <code>Insert Roxygen Skeleton</code> button in RStudio as shown below.</p>
<p><img src="images/add_roxygen.jpg"></p>
<p>More information on documentation in R is provided here: <a href="http://r-pkgs.had.co.nz/man.html" class="uri">http://r-pkgs.had.co.nz/man.html</a></p>
</div>
</div>
<div id="check-your-package" class="section level1">
<h1 class="hasAnchor">
<a href="#check-your-package" class="anchor"></a>3 Check your package</h1>
<p>Once you completed all the steps above go to the upper right panel in RStudio and click on <code>Build</code> -&gt; <code>More</code> -&gt; <code>Configure build tools</code> as shown below.</p>
<p><img src="images/build_check_01.jpg"></p>
<p>Then click on <code>Configure</code> and a new window opens. Here you select everything as shown below:</p>
<p><img src="images/build_check_02.jpg"></p>
<p>After doing so accept the settings by two times clicking <code>Ok</code>.</p>
<p>Subsequently click the <code>Check</code> button so that your package is cross-checked for possible problems (e.g. wrong documentation, missing package dependencies).</p>
<p>In case of missing package dependencies as shown below these should be added to the <a href="http://r-pkgs.had.co.nz/description.html">DESCRIPTION</a> file.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">Namespace dependencies not required<span class="op">:</span><span class="st"> 'fs'</span> <span class="st">'httr'</span> <span class="st">'stringr'</span> <span class="st">'usethis'</span> <span class="st">'yaml'</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">See section <span class="st">'The DESCRIPTION file'</span> <span class="cf">in</span> the <span class="st">'Writing R Extensions'</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">manual.</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="op">*</span><span class="st"> </span>DONE</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">Status<span class="op">:</span><span class="st"> </span><span class="dv">1</span> ERROR</a>
<a class="sourceLine" id="cb13-6" data-line-number="6"></a>
<a class="sourceLine" id="cb13-7" data-line-number="7">See</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">  <span class="st">'C:/Users/myname/Documents/RProjects/kwb.pkgbuild.Rcheck/00check.log'</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="cf">for</span> details.</a>
<a class="sourceLine" id="cb13-10" data-line-number="10"></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">checking package dependencies ... ERROR</a>
<a class="sourceLine" id="cb13-12" data-line-number="12">Namespace dependencies not required<span class="op">:</span><span class="st"> 'fs'</span> <span class="st">'httr'</span> <span class="st">'stringr'</span> <span class="st">'usethis'</span> <span class="st">'yaml'</span></a></code></pre></div>
<p>This can be done using the function <code><a href="https://usethis.r-lib.org/reference/use_package.html">usethis::use_package()</a></code> as shown below:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">pkg_dependencies &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'fs'</span>, <span class="st">'httr'</span>, <span class="st">'stringr'</span>, <span class="st">'usethis'</span>, <span class="st">'yaml'</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(pkg_dependencies, usethis<span class="op">::</span>use_package)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">✔ Adding <span class="st">'fs'</span> to Imports field <span class="cf">in</span> DESCRIPTION</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">● Refer to functions with <span class="st">`</span><span class="dt">fs::fun()</span><span class="st">`</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7">✔ Adding <span class="st">'httr'</span> to Imports field <span class="cf">in</span> DESCRIPTION</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">● Refer to functions with <span class="st">`</span><span class="dt">httr::fun()</span><span class="st">`</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">✔ Adding <span class="st">'stringr'</span> to Imports field <span class="cf">in</span> DESCRIPTION</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">● Refer to functions with <span class="st">`</span><span class="dt">stringr::fun()</span><span class="st">`</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11">✔ Adding <span class="st">'usethis'</span> to Imports field <span class="cf">in</span> DESCRIPTION</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">● Refer to functions with <span class="st">`</span><span class="dt">usethis::fun()</span><span class="st">`</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">✔ Adding <span class="st">'yaml'</span> to Imports field <span class="cf">in</span> DESCRIPTION</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">● Refer to functions with <span class="st">`</span><span class="dt">yaml::fun()</span><span class="st">`</span></a></code></pre></div>
<p>Subsequently you should re-click on the <code>Check</code> button again and it should finish without errors.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">R CMD check results</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="dv">0</span> errors <span class="op">|</span><span class="st"> </span><span class="dv">0</span> warning  <span class="op">|</span><span class="st"> </span><span class="dv">0</span> note </a>
<a class="sourceLine" id="cb15-3" data-line-number="3"></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">R CMD check succeeded</a></code></pre></div>
</div>
<div id="build-your-package" class="section level1">
<h1 class="hasAnchor">
<a href="#build-your-package" class="anchor"></a>4 Build your package</h1>
<p>Now you are ready for building your R package by clicking on the <code>Install and Restart</code> button. A successful installation should finish with <code>Done</code> as shown below:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="op">**</span><span class="st"> </span>building package indices</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="op">**</span><span class="st"> </span>installing vignettes</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="op">**</span><span class="st"> </span>testing <span class="cf">if</span> installed package can be loaded</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="op">*</span><span class="st"> </span><span class="kw">DONE</span> (kwb.pkgbuild)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">In R CMD INSTALL</a></code></pre></div>
</div>
<div id="document-your-package" class="section level1">
<h1 class="hasAnchor">
<a href="#document-your-package" class="anchor"></a>5 Document your package</h1>
<div id="manually" class="section level2">
<h2 class="hasAnchor">
<a href="#manually" class="anchor"></a>5.1 Manually</h2>
<p>Finally you should run <code><a href="https://pkgdown.r-lib.org/reference/build_site.html">pkgdown::build_site()</a></code> in order to create an documentation website for your R package. Running this command will store the website in the subfolder <code>docs</code> within your R package.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">pkgdown<span class="op">::</span><span class="kw"><a href="https://pkgdown.r-lib.org/reference/build_site.html">build_site</a></span>()</a></code></pre></div>
<p>Once you upload your R package to Github this can be easily used as documentation page that you define in the settings page for your R package which is available at:</p>
<p><a href="https://github.com/KWB-R/" class="uri">https://github.com/KWB-R/</a> <code>kwb.mycoolrpackage</code> /settings</p>
<p><img src="images/package_documentation.jpg"></p>
</div>
<div id="automatically" class="section level2">
<h2 class="hasAnchor">
<a href="#automatically" class="anchor"></a>5.2 Automatically</h2>
<p>In case you have already a Github repo defined for your R package you can also automate the process of updating the <code><a href="https://pkgdown.r-lib.org/reference/build_site.html">pkgdown::build_site()</a></code> by with the wrapper function <code><a href="../reference/use_autopkgdown.html">kwb.pkgbuild::use_autopkgdown()</a></code>, which:</p>
<ul>
<li><p>creates a new branch “gh-pages” where the documentation site is deployed</p></li>
<li><p>sets “docs” folder to “.gitignore” (as these files are now build on Travis)</p></li>
<li>
<p>prepares Travis-CI by:</p>
<ul>
<li><p>adding secret key with <code><a href="https://rdrr.io/pkg/travis/man/use_travis_deploy.html">travis::use_travis_deploy()</a></code></p></li>
<li><p>creating “.travis.yml” with <code><a href="../reference/use_travis.html">kwb.pkgbuild::use_travis(auto_build_pkgdown = TRUE)</a></code></p></li>
<li><p>creating an empty “gh-pages” branch with <code><a href="../reference/create_empty_branch_ghpages.html">kwb.pkgbuild::create_empty_branch_ghpages()</a></code></p></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">kwb.pkgbuild<span class="op">::</span><span class="kw">use_autopkgdown</span>()</a></code></pre></div>
<p>Finally to need to go to:</p>
<p><a href="https://github.com/KWB-R/" class="uri">https://github.com/KWB-R/</a> <code>kwb.mycoolrpackage</code> /settings</p>
<p>and set the “source” for Github Pages to the branch “gh-pages”. After each successful Travis build the documentation website is now also updated!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#install-required-r-packages">1 Install required R packages</a></li>
      <li>
<a href="#configure-and-create-your-package">2 Configure and create your package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#prepare-a-package-directory">2.1 Prepare a package directory</a></li>
      <li><a href="#create-empty-r-package">2.2 Create empty R package</a></li>
      <li><a href="#parameterise-your-r-package">2.3 Parameterise your R package</a></li>
      <li><a href="#create-r-package-structure-in-kwb-r-style">2.4 Create R package structure in KWB-R style</a></li>
      <li><a href="#add-your-r-functions">2.5 Add your R functions</a></li>
      </ul>
</li>
      <li><a href="#check-your-package">3 Check your package</a></li>
      <li><a href="#build-your-package">4 Build your package</a></li>
      <li>
<a href="#document-your-package">5 Document your package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#manually">5.1 Manually</a></li>
      <li><a href="#automatically">5.2 Automatically</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://mrustl.de">Michael Rustler</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'd114e26fe8901b7b424d949906e60102',
    indexName: 'kwb_pkgbuild',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
